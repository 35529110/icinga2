_icinga2()
{
  local cur opts
  opts="${COMP_WORDS[*]}"
  cur="${COMP_WORDS[COMP_CWORD]}"
  COMPREPLY=($(icinga2 --autocomplete $COMP_CWORD ${COMP_WORDS[*]} < /dev/null))
  [[ $COMPREPLY = */ ]] && compopt -o nospace
  return 0
}

complete -F _icinga2 icinga2

